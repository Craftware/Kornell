box: pjvds/scala
build:
  steps:
    - script:
        name: print Java version's
        code: |-
          cd $WERCKER_SOURCE_DIR
          java -version || echo "exited with $?"
          scala -version || echo "exited with $?"
          sbt --version || echo "exited with $?"
          mvn -version || echo "exited with $?"
    - script:
        name: install
        code: mvn install
deploy:
  steps:
    - bundle-install
    - script:
        name: Deploy API module
        code: |-
          java -jar tools/eb-ci.jar -a $AWS_ACCESS_KEY_ID -s $AWS_SECRET_KEY -b kornell-api-red -app kornell-api -env kornell-api-red -eb https://elasticbeanstalk.sa-east-1.amazonaws.com -s3 https://s3-sa-east-1.amazonaws.com -war ./kornell-api/target/kornell-api-1.0-SNAPSHOT.war
    - script:
        name: Deploy GUI module
        code: |-
          java -jar tools/eb-ci.jar -a $AWS_ACCESS_KEY_ID -s $AWS_SECRET_KEY -b kornell-api-red -app kornell-api -env kornell-api-red -eb https://elasticbeanstalk.sa-east-1.amazonaws.com -s3 https://s3-sa-east-1.amazonaws.com -war ./kornell-gwt/target/kornell-gwt-0.0.1-SNAPSHOT.war